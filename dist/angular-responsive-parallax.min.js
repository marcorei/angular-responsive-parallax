/*!
 * Angular Responsive Parallax
 *
 * (c) 2014-2015 Markus Riegel <riegel.markus@googlemail.com>
 * License: MIT
 */
!function(t,e,n){var i=e.module("mrResponsiveParallax",[]);i.value("containerDivId","mr-px-container"),i.directive("mrPxParallax",["containerDivId","$timeout",function(i,o){return{restrict:"A",scope:{mrPxMaxPx:"="},link:function(r,a,s){var l,h,d,m,c,p,u,f,g;t.picturefill();var x=function(){if(!l){var t=document.getElementById(i);null===t?(t=e.element('<div style="position:fixed;left:0;top:0;z-index:0;width:100%;height:100%;"></div>'),t.attr("id",i),e.element(document.body).prepend(t)):t=e.element(t),l=e.element('<div style="position:fixed;left:0;top:0;width:100%;height:100%;overflow:hidden;"></div>'),h=e.element('<img style="position:absolute;">'),t.append(l),l.append(h)}var n=a.find("img"),o=n.parent(),r=o.attr("mr-px-size").split(","),s="true"===o.attr("mr-px-no-px"),d=parseFloat(o.attr("mr-px-focal"))>=-1&&parseFloat(o.attr("mr-px-focal"))<=1?parseFloat(o.attr("mr-px-focal")):0;return s?(l.css("display","none"),h.attr("src",""),a.css("display","block")):(l.css("display","block"),h.attr("src",n.attr("src")),a.css("display","none")),{elem:n,oWidth:parseInt(r[0]),oHeight:parseInt(r[1]),noPx:s,focal:d}},v=function(){g&&(t.cancelAnimationFrame(g),g=null),c=x(),p=parseFloat(r.mrPxMaxPx),u={width:t.innerWidth||document.documentElement.clientWidth,height:t.innerHeight||document.documentElement.clientHeight},c.noPx===!0?p=0:g=t.requestAnimationFrame(A)},w=function(){var t=d[0].getBoundingClientRect();m={width:u.width,height:0},p>=0&&1>=p&&(m.height=u.height*(1-p)+t.height*p);var e=c.noPx?t:m,n=c.noPx?c.elem:h,i=e.width/e.height,o=c.oWidth/c.oHeight;o>i?(c.height=e.height,c.width=c.height*o):(c.width=e.width,c.height=c.width/o),n.css("width",c.width+"px"),n.css("height",c.height+"px"),l.css("height",t.height+"px")},y=function(){var t,e=d[0].getBoundingClientRect(),n=0,i=0,o=p,r=c.noPx?c.elem:h;t=.5*-(c.width-m.width),c.noPx?i=.5*-(c.height-e.height):(n=e.top/(u.height-e.height),p>=0&&1>=p&&(i=(u.height-m.height)*n*(1-o)+e.top*o),i=i-e.top-.5*(c.height-m.height)*(1-c.focal)),"none"!==f?(l.css(f,"translate3d(0px,"+e.top+"px,0)"),r.css(f,"translate3d("+t+"px, "+i+"px,0px)")):(l.css("top",e.top+"px"),r.css("top",i+"px"),r.css("left",t+"px"))},P=function(){e.element(t).unbind("resize",z),g&&(t.cancelAnimationFrame(g),g=null),l&&(l.remove(l),h=null)},b=function(){var e,i,o=document.createElement("p"),r={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(o,null);for(var a in r)o.style[a]!==n&&(o.style[a]="translate3d(1px,1px,1px)",e=t.getComputedStyle(o).getPropertyValue(r[a]),i=a);return document.body.removeChild(o),e!==n&&e.length>0&&"none"!==e?i:"none"},F=function(){e.element(t).unbind("load",F),e.element(t).bind("resize",z),z()},z=function(){v(),w(),g||(g=t.requestAnimationFrame(A))},A=function(){y(),g=t.requestAnimationFrame(A)};f=b(),d=a.parent(),a.css("display","none"),o(F),r.$on("$destroy",function(){P()})}}}])}(window,window.angular);